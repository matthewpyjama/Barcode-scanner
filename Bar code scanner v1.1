<!DOCTYPE html>
<html>
<head>
  <title>Barcode Scanner</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
</head>
<body>
  <h1>Scan Barcode</h1>
  <video id="preview" width="300" height="300"></video>
  <div id="result"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      Quagga.init({
        inputStream: {
          name: "Live",
          type: "LiveStream",
          target: document.querySelector("#preview"),
          constraints: {
            facingMode: "environment" // Use back camera
          }
        },
        decoder: {
          readers: ["code_128_reader", "ean_reader", "ean_8_reader", "code_39_reader", "qr_reader"]
        }
      }, function(err) {
        if (err) {
          console.error(err);
          alert("Error initializing Quagga: " + err);
          return;
        }
        Quagga.start();
      });

      Quagga.onDetected(function(result) {
        let barcode = result.codeResult.code;
        document.getElementById("result").innerText = "Scanned: " + barcode;
        window.location.href = `https://script.google.com/macros/s/SCRIPT_ID/exec?code=${barcode}`;
      });
    });
  </script>
</body>
</html>
